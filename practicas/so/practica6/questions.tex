\section{Preguntas teóricas}

\begin{questions}
\question ¿A qué hace referencia el término Virtualización? Investigue cual
fue una de las primeras implementaciones que se realizó.

\question ¿Qué diferencia existe entre Virtualización y Emulación?

\question ¿Qué es un Hypervisor? Investigue cuando se realizó la primer
implementación de esta tecnología.

\question ¿Qué beneficios traen los Hypervisors?

\question ¿Cómo se clasifican los Hypervisors? 

\question Arme un cuadro comparativo de las características de Hypervisors
entre las clasificaciones existentes

\question Indique por qué un hypervisor 1, no podría correr en una
arquitectura sin tecnología de virtualización. ¿Y un Hypervisor 2 en
Hardware sin tecnología de virtualización?

\question Describa brevemente el concepto de paravirtualización.

\question ¿Sería posible utilizar paravirtualización en sistemas como
Windows o iOS? ¿Por qué?

\question Mencione algún sistema que implemente paravirtualización.

\question ¿A qué hace alusión el término VMI?

\question ¿Qué beneficios trae con respecto al resto de los modos de
virtualización?

\question Realice un diagrama que muestre cómo interactúa un SO guest, con
un sistema (HW y Soft) que implemente VMI.

\question Investigue si VMI podría correr sobre Hypervisors 1 o 2, y de una
justificación del por qué.

\question Investigue el término UML en la virtualización, y qué diferencias
encuentra con los modos de virtualización anteriores.

\end{questions}

\section{Ejercicios prácticos}
\textit{Se plantea el escenario donde usted es un administrador de sistemas
  que requiere ejecutar un servicio de forma aislada al resto de los
  procesos.}

\subsection{Ejecución normal}
\begin{questions}
  \question Es la forma más sencilla de ejecutar un servicio y consiste
  simplemente en correrlo como cualquier otro proceso. Ejecute el siguiente
  \textit{script} que símplemente informa al administrador datos básicos
  sobre el sistema operativo, lista el contenido del directorio
  \texttt{/home} y muestra la cantidad de procesos corriendo.
  
  \lstinputlisting[language=sh]{script.sh}

  Este sencillo \textit{script} es capaz de acceder a información del
  sistema operativo como cualquier otro servicio nativo. Esta información
  consiste en archivos y directorios sobre los cuales se tengan permisos de
  lectura, procesos en ejecución, información sobre particiones, interfaces
  de red, etc. En algunos casos suele ser conveniente restringir la
  cantidad de información a la que un proceso puede acceder.
  
\end{questions}

\subsection{chroot}
Uno de los métodos más simples para aislar servicios es \texttt{chroot},
que consiste simplemente en cambiar lo que un proceso junto con sus hijos
consideran que es el directorio raíz, limitando de esta forma lo que pueden
ver en el sistema de archivos. En esta sección de la práctica se preparará
un árbol de directorios que sirva como directorio raíz para una nueva
\textit{shell}.

\begin{questions}
  \question ¿Cuál es la finalidad de la herramienta \texttt{debootstrap}?
  Instálela en un sistema operativo basado en Debian.

  \question La sintaxis de \texttt{debootstrap} para crear un sistema base
  es: \texttt{debootstrap\ <suite>\ <target>\ <mirror>}. Utilice como
  \textit{suite} la versión estable de Debian, \texttt{stable}, como
  \textit{target} el directorio donde alojará el árbol de directorios y
  como \textit{mirror} \texttt{http://httpredir.debian.org/debian}.

  \question Para que un \texttt{chroot} funcione correctamente en Linux se
  deben montar ciertos sistemas de archivos API que necesita el sistema
  operativo.
\begin{verbatim}
# mount --bind /dev/ target/dev/
# mount --bind /proc/ target/proc/
# mount --bind /sys/ target/sys/
\end{verbatim}

  Tenga en cuenta que debe reemplazar \texttt{target/} por el directorio
  donde inicializó su \textit{debootstrap}.

  \question Copie el \textit{script} que ejecutó en la sección anterior a
  un directorio accesible desde el \texttt{chroot}. Por ejemplo,
  \texttt{target/bin/script.sh}.

  \question Ejecute una \textit{shell} cuyo directorio raíz sea
  \texttt{target/}. Para tal fin, utilice con privilegios de \texttt{root}
  el comando \texttt{chroot}.

  \question Ejecute el \textit{script} instalado previamente y analice los
  resultados. ¿Puede ver los procesos que corren en el sistema operativo
  base? ¿Por qué?

  \question ¿Qué desventajas encuentra en el uso de \texttt{chroot} como
  medida de seguridad?

\end{questions}

\subsection{Containers - LXC}
\begin{questions}
\question ¿En qué se diferencia la virtualización tipo VirtualBox de los containers?
\question Ejercicio guiado:

\begin{itemize}
\item Instalar LinuX Containers (LXC) con el comando:
\begin{verbatim}
  	apt-get install lxc
\end{verbatim}
\item Comprobar mediante el siguiente comando que el \textit{kernel} soporta LXC.
\begin{verbatim}
  	lxc-checkconfig
\end{verbatim}
  \textbf{Nota}: puede que no todas las opciones estén habilitadas
\item Para ver los templates que soporta (a partir de donde se crean los containers)
\begin{verbatim}
  	ls /usr/lib/lxc/templates
\end{verbatim}
\item Crear un nuevo container desde el template de Ubuntu con el nombre
  \texttt{soubuntu}:
\begin{verbatim}
  	lxc-create -t ubuntu -n soubuntu
\end{verbatim}
  \textbf{Nota}: durante la instalación se muestra el user/pass para
  ingresar al container. Este comando puede tomar un tiempo porque debe
  bajar muchos componentes la primera vez.
\item Una vez creado el container, el siguiente paso es iniciarla:
\begin{verbatim}
  	lxc-start -n soubuntu -d
\end{verbatim}
  \textbf{Nota}: \texttt{-n} para ingresar el nombre del container que
  queremos iniciar, \texttt{-d} para que corra como daemon
\item Usar el comando \texttt{lxc-list} para ver el estado de los
  containers. ¿En qué estado se encuentra el \textit{container}
  \texttt{soubuntu}?
\item Para ingresar al \textit{container} como si fuese una terminal:
\begin{verbatim}
  	lxc-console -n soubuntu
\end{verbatim}
  
\item Clonar un \textit{container} a usando el comando \texttt{lxc-clone}.
\item Ver el estado de los \textit{containers} con el comando
  \textit{lxc-list}.
\item Detenga el \textit{container} \texttt{soubuntu}.
\begin{verbatim}
  	lxc-shutdown -n soubuntu
\end{verbatim}
\item Usando el archivo \texttt{/var/lib/lxc/soubuntu/config} modificar la
  dirección MAC del \textit{containerx}.

  \textbf{Nota}: puede que tenga que modificar el permiso del directorio
  
\item Para eliminar definitivamente un \textit{container},
\begin{verbatim}
   	lxc-destroy -n soubuntu
\end{verbatim}
  
\end{itemize}

\subsection{Virtualización por hardware}

\end{questions}